<div class="form-subcategory" data-controller="other-account" data-other-account-order-value=<%= order_accounts %>>

  <!-- First nested form for order_accounts (created as nested attribute for order) -->
  <%= f_order.simple_fields_for :order_accounts, OrderAccount.new do |f_order_accounts| %>

    <!-- First serie of radio buttons for already validated accounts -->
    <%= f_order_accounts.collection_radio_buttons(:account_id, Account.validated_accounts_from_subcategory(subcategory), :id, :name, {item_wrapper_class:'account-radio-button'}) do |b_account| %>
      <%= b_account.label {b_account.radio_button(data:{'other-account-target':"radioButtons", action:'click->other-account#radioclicked'}) + content_tag(:span, b_account.text, class:'account-radio-button-text')} %>
    <% end %>
    <!-- Last fake radio button to allow new account form to appear (with a d-none and JS toggle) -->
    <%= f_order_accounts.label "autre", class:'account-other-button', data: {action:'click->other-account#otherclicked','other-account-target':"otherButton"} %>
    <div data-other-account-target='subcategoryDiv'
         class="display-none other-account"
         data-action='keyup->other-account#buttonText keydown->other-account#preventSubmit'>


      <!-- Second nested form for new account (created as nested attribute for order_accounts) -->
      <%= f_order_accounts.simple_fields_for :account, Account.new do |f_account| %>
        <%= f_account.input :name , label: 'Compte à résilier ?' %>
        <%=
          f_account.input :subcategory_id, input_html: { value: subcategory.id }, as: :hidden
          # This hidden field allow us to store the created account in the category
          # where the other button has been clicked
        %>
      <% end %>
    </div>
  <% end %>
</div>

<% content_for :title, "Ajout documents - Eligia" %>


<div class="container">
  <div class="fullscreen">

    <div class="steps"><%= render_breadcrumbs tag: :p, separator:"" %></div>

    <div class="form-order-div" data-controller='check-document' data-check-document-document-value=<%= @order_documents_json %>>
      <div class="form-order-infos">
        <h2>Deuxième étape</h2>
        <p>
          Documents et identifiants à fournir.<br>
          <br><br>
          Tous les champs ci-dessous sont nécessaires. <strong>Vous pouvez néanmoins continuer la procédure sans tous les saisir. Il vous sera possible, par la suite, d'ajouter les documents manquants depuis votre espace personnel.</strong>
        </p>
      </div>
      <%= simple_form_for @order, data: { turbo: false } do |f| %>
        <% @order_documents.each do |order_document| %>
          <div class="insert-document" data-controller="add-file">
            <%= f.simple_fields_for :order_documents, order_document do |fod| %>
              <div class="document-name highlight-yellow"><%= order_document.document.name %></div>
              <% if order_document.document.format == 'pdf' %>
                <div data-check-document-target='infoDiv'></div>
                <div class="document-btn-and-name">
                  <%= fod.input :document_file, label: "Ajouter", as: :file, input_html:{accept: '.png, .jpg, .jpeg, .pdf', class:'hidden-document-input', :'data-action' => "change->add-file#added", :'data-add-file-target' => 'input'}, label_html:{class:'label-document-input', :'data-add-file-target' => 'label', :'data-check-document-target' => 'documentForm'} %>
                  <div class="file-name" data-add-file-target="fileNameDiv"></div>
                </div>
              <% else %>
                <%= fod.input :document_input, label:"#{order_document.document.name} :", input_html: { class:'doc-input' } %>
              <% end %>
            <% end %>
          </div>
        <% end %>
        <div class="order-btn" data-controller="loading-spinner" data-action="click->loading-spinner#load" >
          <%= button_tag(type: 'submit', class: "learn-more", data: {"loading-spinner-target":"btn"}) do %>
            <span class="circle" aria-hidden="true">
              <span class="icon arrow"></span>
            </span>
            <span class="button-text">
                Valider
            </span>
          <% end %>
            <div class="lds-dual-ring display-none" data-loading-spinner-target='spinner'></div>
        </div>
      <% end %>
    </div>
  </div>
</div>

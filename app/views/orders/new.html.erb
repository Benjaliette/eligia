<% content_for :title, "Nouvelle démarche - Eligia" %>


<div class="order-parts">
  <div class="form-order-steps">
    <div class="steps">
      <div class='step current-step'>
        <p>Étape 1 :</p>
        <p>Résiliations</p>
      </div>
      <div class='step'>
        <p>Étape 2 :</p>
        <p>Informations nécessaires</p>
      </div>
      <div class='step'>
        <p>Étape 3 :</p>
        <p>Validation</p>
      </div>
    </div>
    <div class="logo">
      <%= image_tag('eligia-sans-fond-vecto.svg', alt:'Logo Eligia') %>
    </div>
  </div>

  <div class="form-order-div">
    <div class="form-order-infos">
      <%= button_to order_path(@order), method: :delete, class:"btn-third small btn-round margin-bottom-four" do %>
        ← retour à l'accueil
      <% end %>
      <div class="logo">
        <%= image_tag('eligia-sans-fond-vecto.svg', alt:'Logo Eligia') %>
      </div>
      <h1>1. Contrats à résilier</h1>
      <p>
        Renseigner les <strong>abonnements à résilier</strong>.<br><br>
        Pour des raisons de simplicité, les documents et informations à fournir seront demandées à l'étape 2.
      </p>
    </div>

    <div class="form-order-content">
      <% @categories.each do |category| %>
        <div class="order-divs">
          <h3 class="highlight-green fit-content"><%= category.name %></h3>

          <% category.subcategories.each do |subcategory| %>
            <div class="box subcategory-div" data-controller="subcategory-dropdown">
              <div class='subcategory-title' data-action='click->subcategory-dropdown#toggle'>
                <h4><%= subcategory.name %></h4>
                <div class="toggle-btn" data-subcategory-dropdown-target='button'></div>
              </div>
              <div class='subcategory-accounts' data-subcategory-dropdown-target='accounts'>
                <%= render 'chose_account_form', category: category, subcategory: subcategory, order_accounts: @order_accounts, order: @order %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <div class='form-order-right'>
    <div class="form-order-right-list">
      <div class="logo">
        <%= image_tag('eligia-sans-fond-vecto.svg', alt:'Logo Eligia') %>
      </div>
      <h3>Contrats sélectionnés :</h3>
      <div id='account-list' class='account-grid small'></div>
      <% @order.order_accounts.each do |order_account| %>
        <%= render 'order_accounts/account_card', order_account: order_account %>
      <% end %>
    </div>
    <%= simple_form_for @order do |f_order| %>
      <div class="order-btn">
        <%= button_tag(type: 'submit', class: "learn-more") do %>
          <span class="circle" aria-hidden="true">
            <span class="icon arrow"></span>
          </span>
          <span class="button-text">Valider</span>
        <% end %>
      </div>
    <% end %>
  </div>

  <%= link_to contrats_helps_path, target: "_blank", class: 'btn-third small help-btn' do %>
    <div>
      <span>Aide</span>
      <%= image_tag 'help.svg', alt: "icon aide" %>
    </div>
  <% end %>
</div>
